<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Encrypted Form Submission</title>
    <link href="../../dist/spectre.min.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
        .hidden {
            display: none;
        }

        .no-js {
            font-weight: bold;
        }
    </style>
  </head>
  <body class="container grid-md">
    <h1>
      Encrypted Form Submission
    </h1>
    <p>
      This example contains a form that is encrypted using the Web Cryptography API before submission.
      This demonstrates a critical problem that arises in case <strong>JavaScript is partially blocked</strong>, such as
      by a browser extension or the browser's tracking protection.
      If that is the case, the sensitive plaintext data is sent to the server without encryption.
    </p>
    <p>
      The problem of such an environment is that developers may falsely rely on the browser to execute all JavaScript
      code after <em>some</em> code was executed.
    </p>
    <p>
      This example is very similar to the <em>misuse-encrypted-form-submission</em>, however, the encryption hook
      requires a separate JavaScript file to be executed.
      Unlike the example for mishandling of <em>completely</em> blocked JavaScript execution, this example is only
      problematic if parts of the scripts <em>are</em> executed.
      Otherwise, the form is not displayed at all.
    </p>
    <div class="no-js">
      This website requires JavaScript!
      The form is not usable otherwise.
    </div>
    <form class="hidden" method="POST">
      <div>
        <label for="creditCardNumber">
          First Name
        </label>
        <input autofocus
               class="form-input"
               id="firstName"
               name="firstName"
               type="text"
               value="John" />
      </div>

      <div>
        <label for="lastName">
          Last Name
        </label>
        <input class="form-input"
               id="lastName"
               name="lastName"
               type="text"
               value="Doe" />
      </div>

      <div>
        <label for="creditCardNumber">
          Credit Card Number
        </label>
        <input class="form-input"
               id="creditCardNumber"
               name="creditCardNumber"
               type="text"
               value="123456" />
      </div>

      <button class="btn btn-primary"
              type="submit">
        Submit
      </button>
      <button class="btn"
              type="reset">
        Clear
      </button>
    </form>

    <script src="not-blocked-script.js" type="text/javascript"></script>
    <!--
    This script is blocked, e. g., by a browser extension.
    <script type="text/javascript" src="blocked-script.js"></script>
    //-->
  </body>
</html>
